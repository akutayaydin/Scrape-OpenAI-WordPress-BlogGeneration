{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "fa817fa7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Scrape Quora Website"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "2b613cd8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import Library\n",
    "from scrapy import Spider, Request\n",
    "from selenium import webdriver\n",
    "from scrapy.selector import Selector\n",
    "import scrapy\n",
    "from bs4 import BeautifulSoup\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import time\n",
    "\n",
    "from selenium.webdriver.common.by import By\n",
    "from selenium.webdriver.common.keys import Keys\n",
    "from selenium.webdriver.support.ui import WebDriverWait\n",
    "from selenium.webdriver.support import expected_conditions as EC\n",
    "from selenium.webdriver.common.action_chains import ActionChains  \n",
    "\n",
    "from datetime import datetime"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "f1b7bc8d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Start Time: 17:47:20\n",
      "End Time: 17:48:06\n"
     ]
    }
   ],
   "source": [
    "start_time = datetime.now().strftime(\"%H:%M:%S\")\n",
    "print(\"Start Time:\", start_time)\n",
    "\n",
    "\n",
    "# Set up and Launch Chrome Browser in headless mode\n",
    "chrome_options = webdriver.ChromeOptions()\n",
    "chrome_options.add_argument('--headless')\n",
    "chrome_options.add_argument('--no-sandbox')\n",
    "chrome_options.add_argument('--disable-dev-shm-usage')\n",
    "\n",
    "driver = webdriver.Chrome(options=chrome_options)\n",
    "\n",
    "#driver = webdriver.Chrome()\n",
    "\n",
    "login_url = 'https://www.quora.com/'\n",
    "\n",
    "username = '' # Update with your username\n",
    "password = '' # Update with your password\n",
    "\n",
    "# Automated Quora Login \n",
    "# Open the login page\n",
    "driver.get(login_url)\n",
    "\n",
    "# Find the username and password input fields using their HTML attributes\n",
    "username_field = driver.find_element(By.ID, \"email\")\n",
    "password_field = driver.find_element(By.ID, \"password\")\n",
    "\n",
    "# Input the login credentials\n",
    "username_field.send_keys(username)\n",
    "password_field.send_keys(password)\n",
    "\n",
    "# Submit the form\n",
    "password_field.send_keys(Keys.RETURN)\n",
    "\n",
    "end_time = datetime.now().strftime(\"%H:%M:%S\")\n",
    "print(\"End Time:\", end_time)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "240992f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# SET ALL PARAMETERS HERE \n",
    "\n",
    "num_of_questions_to_scrape = 15  # Default 5 Questions\n",
    "wait_time = 1 # Javascript Load Time (Seconds)\n",
    "longer_wait_time = 15 # Scroll wait time (Seconds)\n",
    "num_of_scrolls = 1  # Default 3 (To increase the number of questions to load)\n",
    "more_buttons_to_click = 15 #  number of more buttons to click\n",
    "\n",
    "# Enter all keywords here to scrape\n",
    "#keywords = ['Advertising', 'Health-Eye', 'Brain Health', 'Aging', 'Small Business for Internationals']\n",
    "keywords = ['Data Science']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "be0c93d6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Scraping website for the keyword Data Science.\n",
      "Start Time: 17:48:06\n",
      "Title: (4) Search\n",
      "End Time: 17:49:02\n",
      "Total Time (Scraping List of Questions Related to Keyword):  0:00:55.524002\n",
      "Start Time (Get Question Details): 17:49:02\n",
      "End Time: 17:49:02\n",
      "Total Time: 0:00:00.142521\n",
      "Start Time (Scraping Top Answers For The Questions): 17:49:02\n",
      "Title: (4) How can I become a data scientist? - Quora\n",
      "SCROLL URL: https://www.quora.com/How-can-I-become-a-data-scientist\n",
      "Start Time: 2024-02-26 17:49:16.412022\n",
      "SCROLL URL: https://www.quora.com/How-can-I-become-a-data-scientist\n",
      "Start Time: 2024-02-26 17:49:43.918121\n",
      "SCROLL URL: https://www.quora.com/How-can-I-become-a-data-scientist\n",
      "Start Time: 2024-02-26 17:50:09.930404\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 17:50:25.387430\n",
      "Number of elements found: 107\n",
      "CLICKING ENDS 2024-02-26 17:51:08.856805\n",
      "Title: (4) What is the difference between Data Analytics, Data Analysis, Data Mining, Data Science, Machine Learning, and Big Data? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-is-the-difference-between-Data-Analytics-Data-Analysis-Data-Mining-Data-Science-Machine-Learning-and-Big-Data\n",
      "Start Time: 2024-02-26 17:51:37.604167\n",
      "SCROLL URL: https://www.quora.com/What-is-the-difference-between-Data-Analytics-Data-Analysis-Data-Mining-Data-Science-Machine-Learning-and-Big-Data\n",
      "Start Time: 2024-02-26 17:51:59.215172\n",
      "SCROLL URL: https://www.quora.com/What-is-the-difference-between-Data-Analytics-Data-Analysis-Data-Mining-Data-Science-Machine-Learning-and-Big-Data\n",
      "Start Time: 2024-02-26 17:52:16.103303\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 17:52:32.235799\n",
      "Number of elements found: 160\n",
      "CLICKING ENDS 2024-02-26 17:52:44.537885\n",
      "Title: (4) What are the best, insightful blogs about data, including how businesses are using data? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-insightful-blogs-about-data-including-how-businesses-are-using-data\n",
      "Start Time: 2024-02-26 17:53:17.232122\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-insightful-blogs-about-data-including-how-businesses-are-using-data\n",
      "Start Time: 2024-02-26 17:53:41.100735\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-insightful-blogs-about-data-including-how-businesses-are-using-data\n",
      "Start Time: 2024-02-26 17:53:57.593206\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 17:54:13.017656\n",
      "Number of elements found: 64\n",
      "CLICKING ENDS 2024-02-26 17:54:22.791350\n",
      "Title: (4) What is a data scientist's career path? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-is-a-data-scientists-career-path\n",
      "Start Time: 2024-02-26 17:55:27.911295\n",
      "SCROLL URL: https://www.quora.com/What-is-a-data-scientists-career-path\n",
      "Start Time: 2024-02-26 17:55:48.188072\n",
      "SCROLL URL: https://www.quora.com/What-is-a-data-scientists-career-path\n",
      "Start Time: 2024-02-26 17:56:12.715081\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 17:56:41.920318\n",
      "Number of elements found: 105\n",
      "CLICKING ENDS 2024-02-26 17:58:28.210488\n",
      "Title: (4) What is data science? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-is-data-science\n",
      "Start Time: 2024-02-26 17:59:14.215316\n",
      "SCROLL URL: https://www.quora.com/What-is-data-science\n",
      "Start Time: 2024-02-26 17:59:34.925451\n",
      "SCROLL URL: https://www.quora.com/What-is-data-science\n",
      "Start Time: 2024-02-26 17:59:57.995537\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:00:13.612668\n",
      "Number of elements found: 121\n",
      "CLICKING ENDS 2024-02-26 18:00:48.620183\n",
      "Title: (4) What are good ways to get started with data science for a complete novice? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-are-good-ways-to-get-started-with-data-science-for-a-complete-novice\n",
      "Start Time: 2024-02-26 18:01:15.129022\n",
      "SCROLL URL: https://www.quora.com/What-are-good-ways-to-get-started-with-data-science-for-a-complete-novice\n",
      "Start Time: 2024-02-26 18:01:33.990959\n",
      "SCROLL URL: https://www.quora.com/What-are-good-ways-to-get-started-with-data-science-for-a-complete-novice\n",
      "Start Time: 2024-02-26 18:01:51.174781\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:02:07.628676\n",
      "Number of elements found: 152\n",
      "CLICKING ENDS 2024-02-26 18:03:21.380212\n",
      "Title: (4) What are the best sites for learning Data Science? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-sites-for-learning-Data-Science\n",
      "Start Time: 2024-02-26 18:04:19.124574\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-sites-for-learning-Data-Science\n",
      "Start Time: 2024-02-26 18:04:37.704841\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-sites-for-learning-Data-Science\n",
      "Start Time: 2024-02-26 18:05:14.165891\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:05:31.327336\n",
      "Number of elements found: 95\n",
      "CLICKING ENDS 2024-02-26 18:06:24.866627\n",
      "Title: (4) How do I prepare for a data scientist interview? - Quora\n",
      "SCROLL URL: https://www.quora.com/How-do-I-prepare-for-a-data-scientist-interview\n",
      "Start Time: 2024-02-26 18:07:03.168529\n",
      "SCROLL URL: https://www.quora.com/How-do-I-prepare-for-a-data-scientist-interview\n",
      "Start Time: 2024-02-26 18:07:20.280593\n",
      "SCROLL URL: https://www.quora.com/How-do-I-prepare-for-a-data-scientist-interview\n",
      "Start Time: 2024-02-26 18:07:40.339128\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:07:57.047325\n",
      "Number of elements found: 127\n",
      "CLICKING ENDS 2024-02-26 18:08:49.941205\n",
      "Title: (4) Which institute is the best for the data science course in Delhi? - Quora\n",
      "SCROLL URL: https://www.quora.com/Which-institute-is-the-best-for-the-data-science-course-in-Delhi\n",
      "Start Time: 2024-02-26 18:09:43.461707\n",
      "SCROLL URL: https://www.quora.com/Which-institute-is-the-best-for-the-data-science-course-in-Delhi\n",
      "Start Time: 2024-02-26 18:10:09.085378\n",
      "SCROLL URL: https://www.quora.com/Which-institute-is-the-best-for-the-data-science-course-in-Delhi\n",
      "Start Time: 2024-02-26 18:10:31.812406\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:10:47.685156\n",
      "Number of elements found: 145\n",
      "CLICKING ENDS 2024-02-26 18:11:25.964007\n",
      "Title: (4) Which institute is best for a data science course in Bangalore? - Quora\n",
      "SCROLL URL: https://www.quora.com/Which-institute-is-best-for-a-data-science-course-in-Bangalore\n",
      "Start Time: 2024-02-26 18:12:30.094394\n",
      "SCROLL URL: https://www.quora.com/Which-institute-is-best-for-a-data-science-course-in-Bangalore\n",
      "Start Time: 2024-02-26 18:12:50.617359\n",
      "SCROLL URL: https://www.quora.com/Which-institute-is-best-for-a-data-science-course-in-Bangalore\n",
      "Start Time: 2024-02-26 18:13:37.102163\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:13:52.345636\n",
      "Number of elements found: 103\n",
      "CLICKING ENDS 2024-02-26 18:15:24.183178\n",
      "Title: (4) Which is the best institute for data scientist courses? - Quora\n",
      "SCROLL URL: https://www.quora.com/Which-is-the-best-institute-for-data-scientist-courses\n",
      "Start Time: 2024-02-26 18:16:11.644693\n",
      "SCROLL URL: https://www.quora.com/Which-is-the-best-institute-for-data-scientist-courses\n",
      "Start Time: 2024-02-26 18:16:28.811924\n",
      "SCROLL URL: https://www.quora.com/Which-is-the-best-institute-for-data-scientist-courses\n",
      "Start Time: 2024-02-26 18:17:21.059186\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:17:44.265019\n",
      "Number of elements found: 102\n",
      "CLICKING ENDS 2024-02-26 18:18:15.452513\n",
      "Title: (4) What are some of the best data science courses? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-are-some-of-the-best-data-science-courses\n",
      "Start Time: 2024-02-26 18:18:49.747960\n",
      "SCROLL URL: https://www.quora.com/What-are-some-of-the-best-data-science-courses\n",
      "Start Time: 2024-02-26 18:19:05.110622\n",
      "SCROLL URL: https://www.quora.com/What-are-some-of-the-best-data-science-courses\n",
      "Start Time: 2024-02-26 18:19:20.838980\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:19:35.848498\n",
      "Number of elements found: 178\n",
      "CLICKING ENDS 2024-02-26 18:19:59.735590\n",
      "Title: (4) What is the best data sciences training institute in Hyderabad? - Quora\n",
      "SCROLL URL: https://www.quora.com/What-is-the-best-data-sciences-training-institute-in-Hyderabad\n",
      "Start Time: 2024-02-26 18:20:34.168819\n",
      "SCROLL URL: https://www.quora.com/What-is-the-best-data-sciences-training-institute-in-Hyderabad\n",
      "Start Time: 2024-02-26 18:20:49.335505\n",
      "SCROLL URL: https://www.quora.com/What-is-the-best-data-sciences-training-institute-in-Hyderabad\n",
      "Start Time: 2024-02-26 18:21:05.378233\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:21:20.523925\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Number of elements found: 134\n",
      "CLICKING ENDS 2024-02-26 18:21:37.294971\n",
      "Title: (4) Error\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-resources-for-learning-how-to-use-Python-for-Machine-Learning/Data-Science\n",
      "Start Time: 2024-02-26 18:22:12.451316\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-resources-for-learning-how-to-use-Python-for-Machine-Learning/Data-Science\n",
      "Start Time: 2024-02-26 18:22:28.235086\n",
      "SCROLL URL: https://www.quora.com/What-are-the-best-resources-for-learning-how-to-use-Python-for-Machine-Learning/Data-Science\n",
      "Start Time: 2024-02-26 18:22:43.255956\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:22:58.322482\n",
      "Number of elements found: 0\n",
      "CLICKING ENDS 2024-02-26 18:22:59.458392\n",
      "Title: (4) Why is data science important? - Quora\n",
      "SCROLL URL: https://www.quora.com/Why-is-data-science-important\n",
      "Start Time: 2024-02-26 18:23:54.081325\n",
      "SCROLL URL: https://www.quora.com/Why-is-data-science-important\n",
      "Start Time: 2024-02-26 18:24:11.610691\n",
      "SCROLL URL: https://www.quora.com/Why-is-data-science-important\n",
      "Start Time: 2024-02-26 18:24:55.889323\n",
      "CLICKING ALL MORE BUTTONS.... START TIME: 2024-02-26 18:25:11.585501\n",
      "Number of elements found: 130\n",
      "CLICKING ENDS 2024-02-26 18:25:35.128863\n",
      "Title: (4) Which is the best course for data scientist in Pune? - Quora\n",
      "SCROLL URL: https://www.quora.com/Which-is-the-best-course-for-data-scientist-in-Pune\n",
      "Start Time: 2024-02-26 18:26:11.752053\n",
      "SCROLL URL: https://www.quora.com/Which-is-the-best-course-for-data-scientist-in-Pune\n",
      "Start Time: 2024-02-26 18:26:27.136257\n",
      "Scraping Detail Answers Error:Message: script timeout\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d356a8 chromedriver + 284328\n",
      "3   chromedriver                        0x0000000102db39e4 chromedriver + 801252\n",
      "4   chromedriver                        0x0000000102db3048 chromedriver + 798792\n",
      "5   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "6   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "7   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "8   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "9   chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "10  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "11  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "12  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "13  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "14  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "15  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "16  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "Scraping Detail Answers Error:Message: disconnected: not connected to DevTools\n",
      "  (failed to check if window was closed: disconnected: not connected to DevTools)\n",
      "  (Session info: chrome-headless-shell=121.0.6167.184)\n",
      "Stacktrace:\n",
      "0   chromedriver                        0x00000001030ca814 chromedriver + 4040724\n",
      "1   chromedriver                        0x00000001030c2a18 chromedriver + 4008472\n",
      "2   chromedriver                        0x0000000102d35870 chromedriver + 284784\n",
      "3   chromedriver                        0x0000000102d1e0d8 chromedriver + 188632\n",
      "4   chromedriver                        0x0000000102d1e004 chromedriver + 188420\n",
      "5   chromedriver                        0x0000000102db2778 chromedriver + 796536\n",
      "6   chromedriver                        0x0000000102d6d74c chromedriver + 513868\n",
      "7   chromedriver                        0x0000000102d6e044 chromedriver + 516164\n",
      "8   chromedriver                        0x000000010308fa3c chromedriver + 3799612\n",
      "9   chromedriver                        0x0000000103093f1c chromedriver + 3817244\n",
      "10  chromedriver                        0x0000000103078298 chromedriver + 3703448\n",
      "11  chromedriver                        0x0000000103094a64 chromedriver + 3820132\n",
      "12  chromedriver                        0x000000010306b054 chromedriver + 3649620\n",
      "13  chromedriver                        0x00000001030b1e74 chromedriver + 3939956\n",
      "14  chromedriver                        0x00000001030b1fec chromedriver + 3940332\n",
      "15  chromedriver                        0x00000001030c2698 chromedriver + 4007576\n",
      "16  libsystem_pthread.dylib             0x000000019a3ac26c _pthread_start + 148\n",
      "17  libsystem_pthread.dylib             0x000000019a3a708c thread_start + 8\n",
      "\n",
      "End Time: 18:28:35\n",
      "Work for Search Term Data Science ends here.\n",
      "Total Time For Keyword Scraping:  0:40:29.256988\n",
      "....-----o-----....\n",
      "\n"
     ]
    }
   ],
   "source": [
    "\n",
    "for search_term in keywords:\n",
    "    try:\n",
    "        print ('Scraping website for the keyword ' + str(search_term) + '.')\n",
    "\n",
    "        start_time_for_keyword_scraping = datetime.now()\n",
    "\n",
    "        start_time = datetime.now()\n",
    "        print(\"Start Time:\", start_time.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "        # Scrape the url address\n",
    "        # TODO: This code can be change to web crawling instead of the manuel url entry\n",
    "        url = 'https://www.quora.com/search?q=' + search_term\n",
    "\n",
    "        driver.get(url)\n",
    "        print('Title: ' + str(driver.title))\n",
    "        # The website is dynamic - Scroll webpage # of times  \n",
    "        for i in range(num_of_scrolls): # adjust the number of scrolls\n",
    "            # Scroll down by the height of the window\n",
    "            driver.execute_script(\"window.scrollTo(0, document.body.scrollHeight);\")\n",
    "\n",
    "            # Wait for a short time to allow content to load (adjust as needed)\n",
    "            time.sleep(longer_wait_time)\n",
    "            \n",
    "        end_time = datetime.now()\n",
    "        print(\"End Time:\", end_time.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "        total_time = end_time - start_time\n",
    "        print('Total Time (Scraping List of Questions Related to Keyword): ', total_time)\n",
    "\n",
    "    \n",
    "        # Wait for a short time to allow content to load (adjust as needed)\n",
    "        #time.sleep(longer_wait_time)\n",
    "            \n",
    "        # Wait for some time to allow JavaScript to load\n",
    "        driver.implicitly_wait(longer_wait_time)\n",
    "\n",
    "        # Get the source code after JavaScript has loaded\n",
    "        body = driver.page_source\n",
    "\n",
    "        # Create a Scrapy Selector from the HTML source\n",
    "        select = Selector(text=body)\n",
    "\n",
    "        start_time = datetime.now()\n",
    "        print(\"Start Time (Get Question Details):\", start_time.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "        # Create the dataframe with the Quora Data Columns\n",
    "        df_quora = pd.DataFrame(columns = ['Question', 'Link','NumFollow','NumUpvote','NumAnswer','SearchTerm','TopContent1','TopContent2','TopContent3'])\n",
    "\n",
    "        \n",
    "\n",
    "\n",
    "        # Scrape different questions types \n",
    "        # Some questions have follow data and some questions have upvote data.\n",
    "        main_rows = select.xpath('//div[contains(@class, \"q-box puppeteer_test_question_component_base\")]').getall() # Main Questions\n",
    "        tiny_rows = select.xpath('//div[contains(@class, \"q-box qu-borderBottom qu-p--medium qu-pb--tiny\")]').getall() # Tiny Questions\n",
    "\n",
    "        for row in main_rows:\n",
    "            soup = BeautifulSoup(row, 'html.parser')\n",
    "            row_text = soup.get_text()\n",
    "\n",
    "            # Find the elements with the specified class\n",
    "            question_element = soup.find('div', class_='q-inline qu-flexWrap--wrap')\n",
    "            follow_element = soup.find('span', class_='q-text qu-whiteSpace--nowrap qu-display--inline-flex qu-alignItems--center qu-justifyContent--center')\n",
    "            answer_num_element = soup.find('a', class_ = 'q-box Link___StyledBox-t2xg9c-0 dFkjrQ puppeteer_test_link qu-cursor--pointer qu-hover--textDecoration--underline')\n",
    "\n",
    "            if question_element is not None and follow_element is not None and answer_num_element is not None:\n",
    "                # print('Question: '+ str(question_element.get_text()) + ' ' + 'Follow: ' + str(follow_element.get_text()) + ' ' + 'Num of Answer: ' + str(answer_num_element.get_text()))\n",
    "\n",
    "                question = question_element.get_text()\n",
    "                #print('Before:' + question)\n",
    "                html = question.replace(' ', '-').replace('(', '-').replace(')', '-').replace(',', '-').replace('.', '-').replace('\"', '-').replace('\\'', '').replace('--', '-')\n",
    "                html = html.replace('--','-').replace('-?', '').replace('?', '')\n",
    "                html = 'https://www.quora.com/'+html\n",
    "                #print('After:' + html)\n",
    "                num_follow = follow_element.get_text()\n",
    "\n",
    "                num_answer = answer_num_element.get_text()\n",
    "                \n",
    "                num_upvote = 0\n",
    "                \n",
    "                if 'K' in num_follow: \n",
    "                    num_follow = float(num_follow.replace('K', '')) * 1000\n",
    "                else: \n",
    "                    num_follow = float(num_follow)\n",
    "\n",
    "                new_row = pd.DataFrame({'Question': [question],'Link': [html],'NumFollow': [num_follow],'NumUpvote': [num_upvote],'NumAnswer': [num_answer], 'SearchTerm': [search_term]})\n",
    "                df_quora = pd.concat([df_quora,new_row],ignore_index = True)\n",
    "                #print('Questions OK HERE')\n",
    "            else:\n",
    "                print(\"Not found!\")\n",
    "\n",
    "        for row in tiny_rows:\n",
    "            soup = BeautifulSoup(row, 'html.parser')\n",
    "            row_text = soup.get_text()\n",
    "\n",
    "            # Find the elements with the specified class\n",
    "            question_element = soup.find('div', class_='q-inline qu-flexWrap--wrap')\n",
    "            upvote_element = soup.find('span', class_='q-text qu-whiteSpace--nowrap qu-display--inline-flex qu-alignItems--center qu-justifyContent--center')\n",
    "\n",
    "            if question_element is not None and upvote_element is not None:\n",
    "                #print('Question: '+ str(question_element.get_text()) + ' ' + 'Upvote: ' + str(upvote_element.get_text()))\n",
    "\n",
    "                question = question_element.get_text()\n",
    "\n",
    "                html = question.replace(' ', '-').replace('(', '-').replace(')', '-').replace(',', '-').replace('.', '-').replace('\"', '-').replace('\\'', '').replace('--', '-')\n",
    "                html = html.replace('--','-').replace('-?', '').replace('?', '')\n",
    "                html = 'https://www.quora.com/'+html\n",
    "\n",
    "                num_follow = '0'\n",
    "\n",
    "                num_answer = '0'\n",
    "\n",
    "                num_upvote = upvote_element.get_text()\n",
    "                \n",
    "                if 'K' in num_upvote: \n",
    "                    num_upvote = float(num_upvote.replace('K', '')) * 1000\n",
    "                else: \n",
    "                    num_upvote = float(num_upvote)\n",
    "\n",
    "                new_row = pd.DataFrame({'Question': [question],'Link': [html],'NumFollow': [num_follow],'NumAnswer': [num_answer],'NumUpvote': [num_upvote], 'SearchTerm': [search_term], 'Status': ['New']})\n",
    "                df_quora = pd.concat([df_quora,new_row],ignore_index = True)\n",
    "            else:\n",
    "                print(\"Not found!\")\n",
    "\n",
    "        end_time = datetime.now()\n",
    "        print(\"End Time:\", end_time.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "        total_time = end_time - start_time\n",
    "        print('Total Time:', total_time)\n",
    "        \n",
    "    except Exception as e:\n",
    "        print('Error: ' + str(e))\n",
    "        continue\n",
    "        \n",
    "    #print(df_quora)\n",
    "    \n",
    "    # Function to click the \"more\" button using Selenium\n",
    "    def click_more_button(driver):\n",
    "        try:\n",
    "            print('CLICKING ALL MORE BUTTONS....'+ ' START TIME: '+ str(datetime.now()))\n",
    "            #wait = WebDriverWait(driver, 10)\n",
    "            #more_buttons = wait.until(EC.presence_of_all_elements_located((By.CLASS_NAME, 'qt_read_more')))\n",
    "            more_buttons = driver.find_elements(By.CLASS_NAME, 'qt_read_more')\n",
    "\n",
    "            print(\"Number of elements found:\", len(more_buttons))\n",
    "\n",
    "            for button in more_buttons[:more_buttons_to_click]: # it takes to much time to click more button\n",
    "                try:\n",
    "                    # Scroll the element into view\n",
    "                    ActionChains(driver).move_to_element(button).perform()\n",
    "                    # Click the button using JavaScript to bypass potential issues\n",
    "                    driver.execute_script(\"arguments[0].click();\", button)\n",
    "\n",
    "                    #print('Time: ' + str(datetime.now()))\n",
    "\n",
    "                except Exception as e:\n",
    "                    print(f\"Error clicking button: {e}\")\n",
    "\n",
    "        except Exception as e:\n",
    "            print(f\"Error clicking button: {e}\")\n",
    "\n",
    "\n",
    "\n",
    "    start_time = datetime.now()\n",
    "    print(\"Start Time (Scraping Top Answers For The Questions):\", start_time.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "    # Sort The dataframe based on Follow and Upvote numbers\\\n",
    "    try:\n",
    "        df_quora[['NumFollow', 'NumUpvote']] = df_quora[['NumFollow', 'NumUpvote']].astype(int)\n",
    "        #df_quora['TotalScore'] = df_quora['NumFollow'] + df_quora['NumUpvote']\n",
    "\n",
    "        df_quora['TotalScore'] = df_quora[['NumFollow','NumUpvote']].sum(axis=1, numeric_only=True)\n",
    "        #print('Total Score:')\n",
    "        #print(df_quora['TotalScore'])\n",
    "        #df_quora.sort_values(by=['NumFollow', 'NumUpvote'], ascending=False, inplace=True)\n",
    "        df_quora.sort_values(by=['TotalScore'], ascending=False, inplace=True)\n",
    "        df_quora.reset_index(drop=True, inplace=True)\n",
    "    except Exception as e:\n",
    "        print('Sorting Error:' +str(e))\n",
    "    \n",
    "    #print(df_quora)\n",
    "    \n",
    "    for index,row_url in df_quora.iterrows():\n",
    "        try:\n",
    "            #print('MUST HAVE CHECK 1')\n",
    "            #print('Index:' +str(index))\n",
    "            # TO DO: ONLY SCRAPE THE LINKS WITH STATUS NEW \n",
    "            # TODO: Change Number of questions to scrape and assign it to a counter\n",
    "\n",
    "            if index < num_of_questions_to_scrape: # Only scrape X num of questions of top contents\n",
    "                url = df_quora.iloc[index,1]\n",
    "                #print('MUST HAVE CHECK 2')\n",
    "\n",
    "                driver.get(url)\n",
    "                print('Title: ' + str(driver.title))\n",
    "\n",
    "                # The website is dynamic - Scroll webpage # of times  \n",
    "                for i in range(num_of_scrolls): # adjust the number of scrolls\n",
    "\n",
    "                    print('SCROLL URL: ' + url)\n",
    "                    print('Start Time: ' + str(datetime.now()))\n",
    "                    # Scroll down by the height of the window\n",
    "                    driver.execute_script(\"window.scrollTo(0, document.body.scrollHeight);\")\n",
    "\n",
    "                    # Wait for a short time to allow content to load (adjust as needed)\n",
    "                    time.sleep(longer_wait_time)\n",
    "\n",
    "\n",
    "                # Click the \"more\" button if it exists\n",
    "                click_more_button(driver)\n",
    "                print('CLICKING ENDS ' + str(datetime.now()))\n",
    "\n",
    "                # Wait for a short time to allow content to load (adjust as needed)\n",
    "                #time.sleep(longer_wait_time)\n",
    "\n",
    "                # Wait for some time to allow JavaScript to load\n",
    "                driver.implicitly_wait(wait_time)\n",
    "                body = driver.page_source\n",
    "\n",
    "                # Create a Scrapy Selector from the HTML source\n",
    "                select = Selector(text=body)\n",
    "\n",
    "                # Scrape top 3 answers of each question\n",
    "                count = 1 \n",
    "                content_element_temp = ''\n",
    "\n",
    "                top_3_content = pd.DataFrame(columns = ['index','url','content','upvote'])\n",
    "\n",
    "                tiny_rows = select.xpath('//div[contains(@class, \"q-box\")]').getall() # Tiny Questions\n",
    "\n",
    "                for index, row in enumerate(tiny_rows):\n",
    "                    #start_time_1 = datetime.now()\n",
    "                    #print(\"Tiny questions start time: \", start_time_1.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "                    soup = BeautifulSoup(row, 'html.parser')\n",
    "                    row_text = soup.get_text()\n",
    "\n",
    "                    # Find the elements with the specified class\n",
    "                    content_element = soup.select_one('div.q-box.spacing_log_answer_content.puppeteer_test_answer_content')\n",
    "\n",
    "                    upvote_element = soup.find('span', class_='q-text qu-whiteSpace--nowrap qu-display--inline-flex qu-alignItems--center qu-justifyContent--center')\n",
    "\n",
    "                    # Check if it is a promotional content\n",
    "                    is_promotion = soup.find('div', class_='q-text', text='Promoted')\n",
    "\n",
    "                    if not is_promotion: \n",
    "                        if content_element_temp != content_element:\n",
    "                            if content_element is not None and upvote_element is not None:\n",
    "                                #print('Question: '+ str(question_element.get_text()) + ' ' + 'Upvote: ' + str(upvote_element.get_text()))\n",
    "                                content = content_element.get_text()\n",
    "\n",
    "                                num_upvote = upvote_element.get_text()\n",
    "\n",
    "                                # replace K character by multiplying num of upvote to 1000\n",
    "                                if 'K' in num_upvote: \n",
    "                                    num_upvote = float(num_upvote.replace('K', '')) * 1000\n",
    "                                else: \n",
    "                                    num_upvote = float(num_upvote)\n",
    "\n",
    "                                # Dont save data with missing content\n",
    "                                if ' (more)' not in content :\n",
    "                                    new_row = pd.DataFrame({'index': [index],'url':[url], 'content': [content], 'upvote': [num_upvote]})\n",
    "                                    top_3_content = pd.concat([top_3_content,new_row],ignore_index = True)\n",
    "                                    top_3_content = top_3_content.sort_values(by='upvote', ascending = False)\n",
    "\n",
    "                                content_element_temp = content_element\n",
    "\n",
    "                        #end_time_1 = datetime.now()\n",
    "                        #print(\"Tiny questions end time: \", end_time_1.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "                # Only Get the Sorted Top 3 Answers\n",
    "                top_3_content = top_3_content.head(3)\n",
    "\n",
    "                # Update quora dataframe by adding top 3 answers using url as the unique key\n",
    "                for index, row in top_3_content.iterrows(): \n",
    "                    for index_quora, row_quora in df_quora.iterrows():\n",
    "                        if row_quora['Link'] == row ['url']:\n",
    "                            df_quora.loc[index_quora, str('TopContent') + str(count)] = str(row['content'])\n",
    "                            df_quora.loc[index_quora, 'Status'] = 'New'\n",
    "                            count += 1\n",
    "                            break\n",
    "            else:\n",
    "                break\n",
    "        except Exception as e:\n",
    "            print('Scraping Detail Answers Error:' + str(e))\n",
    "    \n",
    "    \n",
    "        \n",
    "    end_time = datetime.now()\n",
    "    print(\"End Time:\", end_time.strftime(\"%H:%M:%S\"))\n",
    "\n",
    "    total_time = end_time - start_time_for_keyword_scraping\n",
    "    print('Work for Search Term ' + str(search_term) + ' ends here.')\n",
    "    print('Total Time For Keyword Scraping: ', total_time)\n",
    "    print('....-----o-----....')\n",
    "    print('')\n",
    "    \n",
    "    create_time = datetime.now().strftime(\"%Y-%m-%d %H_%M\")\n",
    "\n",
    "    # Create Backup\n",
    "    file_name = 'Quora_' + search_term + '_' + create_time + '.csv'\n",
    "    file_name = 'Quora_Scraped_Data.csv'\n",
    "    df_quora.to_csv(file_name,mode = 'w', header = True, index = False)\n",
    "    try:\n",
    "        del df_quora\n",
    "        del new_row\n",
    "    except Exception as e:\n",
    "        print('Error: ' + str(e))\n",
    "        \n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "536e147a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Close the browser\n",
    "driver.quit()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
